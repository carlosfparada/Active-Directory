---
plugin: microsoft.ad.ldap
# server: "{{ server }}"
# username: "{{ username }}"
# password: "{{ password }}"
server: 20.234.51.182
username: cparada
password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33656364313364313736626334363135623533663636323563383039366461376336646532313438
          6661316564653165626664613262636633326130633061310a313732636238623233313263613466
          62643731326161616162613936326137333566343638313732373166373962313830383230313730
          3931303739643765630a353934373836613166323533616338393237626664356266396139336631
          3231
tls_mode: start_tls
attributes:
  OperatingSystem:
    operating_system:
  location:
  memberOf:
    computer_membership: this | map("regex_search", '^CN=(?P<name>.+?)((?<!\\),)', '\g<name>') | flatten
groups:
  windows: true
  production: '"Production" in computer_membership'
keyed_groups:
- key: operating_system | lower
  prefix: os
  default_value: unknown
- key: location | lower
  default_value: unknown
  prefix: location